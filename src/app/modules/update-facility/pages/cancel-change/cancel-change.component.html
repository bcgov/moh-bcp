<h1 [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_TITLE'></h1>
<p [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_DESCRIPTION'></p>
<hr/>

<common-page-section layout='noTips'>
  <form [formGroup]="formGroup">
    <h2 [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_ADDRESS_TITLE'></h2>
    <div [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_ADDRESS_DESCRIPTION'></div>
    <hr/>
    
    <a name='physical-address'></a>
    <div class="form-group pl-4">
      <common-checkbox label='Change facility physical address'
                       formControlName='checkChangeFacilityAddress'></common-checkbox>
    </div>

    <div *ngIf='dataService.checkChangeFacilityAddress'
         class='border-left ml-4 pl-3'>
      <h3>Previous facility physical address</h3>
      <hr/>

      <form [formGroup]="changeFacilityAddressFG">

        <!-- Change Facility Address -->

        <div class='ml-4'>
          <div class="form-group">
            <common-geocoder-input label='Facility physical address'
                              formControlName='changeFacilityAddressPreviousAddress'
                              maxlength='60'
                              (select)='changeFacilityAddressPreviousAddressSelected($event)'></common-geocoder-input>
            <common-error-container [displayError]="changeFacilityAddressFG.controls?.changeFacilityAddressPreviousAddress?.touched && changeFacilityAddressFG.controls?.changeFacilityAddressPreviousAddress?.errors">
              <div *ngIf="changeFacilityAddressFG.controls?.changeFacilityAddressPreviousAddress?.errors?.required">
                  Facility address is a required field
              </div>
              <div *ngIf="changeFacilityAddressFG.controls?.changeFacilityAddressPreviousAddress?.errors?.maxlength">
                  Facility address max length must be 60 or fewer characters.
              </div>
              <div *ngIf="changeFacilityAddressFG.controls?.changeFacilityAddressPreviousAddress?.errors?.pattern">
                  Facility address must contain letters, numbers and/or symbols(e.g. #, @, !).
              </div>
            </common-error-container>
          </div>

          <div class="form-group">
            <common-city label='City'
                        name="changeFacilityAddressPreviousCity"
                        formControlName="changeFacilityAddressPreviousCity"
                        placeholder=""
                        [maxlength]="30"></common-city>
          </div>

          <div class="form-group">
            <div class='label'>Province</div>
            <div class='pb-2'>British Columbia</div>
          </div>

          <div class="form-group">
            <common-postal-code name="changeFacilityAddressPreviousPostalCode"
                                label='Postal code'
                                placeholder=''
                                formControlName="changeFacilityAddressPreviousPostalCode">
            </common-postal-code>
          </div>

          <div class="form-group">
            <common-phone-number name='changeFacilityAddressPreviousFax'
                                formControlName='changeFacilityAddressPreviousFax'
                                label='Contact fax number (optional)'
                                [enablePlaceHolder]='false'
                                [allowInternational]='false'></common-phone-number>
          </div>
        </div>

        <h3>New facility physical address</h3>
        <hr/>

        <div class='ml-4'>
          <div class="form-group">
            <!-- Label has intentional trailing space for accessiblity validators -->
            <common-geocoder-input label='Facility physical address '
                              formControlName='changeFacilityAddressNewAddress'
                              maxlength='60'
                              (select)='changeFacilityAddressNewAddressSelected($event)'></common-geocoder-input>
            <common-error-container [displayError]="changeFacilityAddressFG.controls?.changeFacilityAddressNewAddress?.touched && changeFacilityAddressFG.controls?.changeFacilityAddressNewAddress?.errors">
              <div *ngIf="changeFacilityAddressFG.controls?.changeFacilityAddressNewAddress?.errors?.required">
                  Facility address is a required field
              </div>
              <div *ngIf="changeFacilityAddressFG.controls?.changeFacilityAddressNewAddress?.errors?.maxlength">
                  Facility address max length must be 60 or fewer characters.
              </div>
              <div *ngIf="changeFacilityAddressFG.controls?.changeFacilityAddressNewAddress?.errors?.pattern">
                  Facility address must contain letters, numbers and/or symbols(e.g. #, @, !).
              </div>
            </common-error-container>
          </div>

          <div class="form-group">
            <common-city label='City'
                          name="changeFacilityAddressNewCity"
                          formControlName="changeFacilityAddressNewCity"
                          placeholder=""
                          [maxlength]="30"></common-city>
          </div>

          <div class="form-group">
            <div class='label'>Province</div>
            <div class='pb-2'>British Columbia</div>
          </div>

          <div class="form-group">
            <common-postal-code name="changeFacilityAddressNewPostalCode"
                                label='Postal code'
                                placeholder=''
                                formControlName="changeFacilityAddressNewPostalCode">
            </common-postal-code>
          </div>

          <div class="form-group">
            <common-phone-number name='changeFacilityAddressNewFax'
                                formControlName='changeFacilityAddressNewFax'
                                label='Contact fax number (optional)'
                                [enablePlaceHolder]='false'
                                [allowInternational]='false'></common-phone-number>
          </div>
        </div>

        <div class="form-group">
          <common-date name='changeFacilityAddressEffectiveDate'
                       formControlName='changeFacilityAddressEffectiveDate'
                       label='Effective date of address change'
                       [dateRangeStart]='retroActiveStartDate'
                       [errorMessage]='retroActiveStartDateErrorMessage'></common-date>
        </div>
      </form>
      
    </div>

<!-- Change Mailing Address-->

    <a name='mailing-address'></a>
    <div class="form-group pl-4">
      <common-checkbox label='Change facility mailing address'
                        formControlName='checkChangeMailingAddress'></common-checkbox>
    </div>

    <div *ngIf='dataService.checkChangeMailingAddress'
          class='border-left ml-4 pl-3'>
      <h3>Previous mailing address</h3>
      <hr/>

      <form [formGroup]="changeMailingAddressFG">
        <div class='ml-4'>
          <div class="form-group">
            <common-geocoder-input label='Mailing address'
                              formControlName='changeMailingAddressPreviousAddress'
                              maxlength='60'
                              (select)='changeMailingAddressPreviousAddressSelected($event)'></common-geocoder-input>
            <common-error-container [displayError]="changeMailingAddressFG.controls?.changeMailingAddressPreviousAddress?.touched && changeMailingAddressFG.controls?.changeMailingAddressPreviousAddress?.errors">
              <div *ngIf="changeMailingAddressFG.controls?.changeMailingAddressPreviousAddress?.errors?.required">
                  Mailing address is a required field
              </div>
              <div *ngIf="changeMailingAddressFG.controls?.changeMailingAddressPreviousAddress?.errors?.maxlength">
                  Mailing address max length must be 60 or fewer characters.
              </div>
              <div *ngIf="changeMailingAddressFG.controls?.changeMailingAddressPreviousAddress?.errors?.pattern">
                  Mailing address must contain letters, numbers and/or symbols(e.g. #, @, !).
              </div>
            </common-error-container>
          </div>

          <div class="form-group">
            <common-city label='City'
                          name="changeMailingAddressPreviousCity"
                          formControlName="changeMailingAddressPreviousCity"
                          placeholder=""
                          [maxlength]="30"></common-city>
          </div>

          <div class="form-group">
            <div class='label'>Province</div>
            <div class='pb-2'>British Columbia</div>
          </div>

          <div class="form-group">
            <common-postal-code name="changeMailingAddressPreviousPostalCode"
                                label='Postal code'
                                placeholder=''
                                formControlName="changeMailingAddressPreviousPostalCode">
            </common-postal-code>
          </div>
        </div>

        <h3>New Mailing Address</h3>
        <hr/>

        <div class='ml-4'>
          <div class="form-group">
            <!-- Label has intentional trailing space for accessiblity validators -->
            <common-geocoder-input label='Mailing address '
                              formControlName='changeMailingAddressNewAddress'
                              maxlength='60'
                              (select)='changeMailingAddressNewAddressSelected($event)'></common-geocoder-input>
            <common-error-container [displayError]="changeMailingAddressFG.controls?.changeMailingAddressNewAddress?.touched && changeMailingAddressFG.controls?.changeMailingAddressNewAddress?.errors">
              <div *ngIf="changeMailingAddressFG.controls?.changeMailingAddressNewAddress?.errors?.required">
                  Mailing address is a required field
              </div>
              <div *ngIf="changeMailingAddressFG.controls?.changeMailingAddressNewAddress?.errors?.maxlength">
                  Mailing address max length must be 60 or fewer characters.
              </div>
              <div *ngIf="changeMailingAddressFG.controls?.changeMailingAddressNewAddress?.errors?.pattern">
                  Mailing address must contain letters, numbers and/or symbols(e.g. #, @, !).
              </div>
            </common-error-container>
          </div>

          <div class="form-group">
            <common-city label='City'
                          name="changeMailingAddressNewCity"
                          formControlName="changeMailingAddressNewCity"
                          placeholder=""
                          [maxlength]="30"></common-city>
          </div>

          <div class="form-group">
            <div class='label'>Province</div>
            <div class='pb-2'>British Columbia</div>
          </div>

          <div class="form-group">
            <common-postal-code name="changeMailingAddressNewPostalCode"
                                label='Postal code'
                                placeholder=''
                                formControlName="changeMailingAddressNewPostalCode">
            </common-postal-code>
          </div>
        </div>

        <div class="form-group">
          <common-date name='changeMailingAddressEffectiveDate'
                        formControlName='changeMailingAddressEffectiveDate'
                        label='Effective date of address change'
                        [dateRangeStart]='retroActiveStartDate'
                        [errorMessage]='retroActiveStartDateErrorMessage'></common-date>
        </div>
      </form>
    </div>
    
<!-- Business Cost Premium -->

    <a name='bcp'></a>
    <h2 class='mt-5' [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_BCP_TITLE'></h2>
    <div [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_BCP_DESCRIPTION'></div>
    <hr/>

<!-- BCP Change applies to fees -->
    
    <div class="form-group pl-4">
      <common-checkbox label='The applicant requests that BCP applies to Eligible Fees of Eligible Physicians attached to this facility.'
                        formControlName='checkChangeAppliesFees'></common-checkbox>
    </div>

    <div *ngIf='dataService.checkChangeAppliesFees'
          class='border-left ml-4 pl-3'>
      <form [formGroup]="changeAppliesFeesFG">
        <div class="form-group">
          <common-date name='changeAppliesFeesEffectiveDate'
                       formControlName='changeAppliesFeesEffectiveDate'
                       label='Effective date'
                       [dateRangeStart]='bcpStartDate'
                       [errorMessage]='dateErrorMessage'></common-date>
        </div>
      </form>
    </div>

    <p>Indicate below to cancel BCP enrolment or change the BCP effective/cancellation date.</p>

<!-- BCP Cancel -->
    
    <div class="form-group pl-4">
      <common-checkbox label='Cancel BCP'
                        formControlName='checkCancelBCP'></common-checkbox>
    </div>

    <div *ngIf='dataService.checkCancelBCP'
          class='border-left ml-4 pl-3'>
      <form [formGroup]="cancelBCPFG">
        <div class="form-group">
          <common-date name='cancelBCPEffectiveDate'
                        formControlName='cancelBCPEffectiveDate'
                        label='Cancel effective date'
                        [dateRangeStart]='bcpStartDate'
                        [errorMessage]='dateErrorMessage'></common-date>
        </div>
      </form>
    </div>

<!-- BCP Change Effective Date -->
    
    <div class="form-group pl-4">
      <common-checkbox label='Change BCP effective date'
                        formControlName='checkChangeBCPEffectiveDate'></common-checkbox>
    </div>

    <div *ngIf='dataService.checkChangeBCPEffectiveDate'
          class='border-left ml-4 pl-3'>
      <form [formGroup]="changeBCPEffectiveDateFG">
        <div class="form-group">
          <common-date name='changeBCPEffectiveDateEffectiveDate'
                        formControlName='changeBCPEffectiveDateEffectiveDate'
                        label='New BCP effective date'
                        [dateRangeStart]='bcpStartDate'
                        [errorMessage]='dateErrorMessage'></common-date>
        </div>
      </form>
    </div>

<!-- BCP Change Cancel Date -->
    
    <div class="form-group pl-4">
      <common-checkbox label='Change BCP cancellation date'
                        formControlName='checkChangeBCPCancelDate'></common-checkbox>
    </div>

    <div *ngIf='dataService.checkChangeBCPCancelDate'
          class='border-left ml-4 pl-3'>
      <form [formGroup]="changeBCPCancelDateFG">
        <div class="form-group">
          <common-date name='changeBCPCancelDateCancelDate'
                        formControlName='changeBCPCancelDateCancelDate'
                        label='New BCP cancel date'
                        [dateRangeStart]='bcpStartDate'
                        [errorMessage]='dateErrorMessage'></common-date>
        </div>
      </form>
    </div>

    <a name='change-admin'></a>
    <h2 class='mt-5' [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_ADMIN_TITLE'></h2>
    <div [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_ADMIN_DESCRIPTION'></div>
    <hr/>

<!-- BCP Change Cancel Date -->

    <div class="form-group pl-4">
      <common-checkbox label='Change Administrator information'
                        formControlName='checkChangeAdminInfo'></common-checkbox>
    </div>

    <div *ngIf='dataService.checkChangeAdminInfo'
          class='border-left ml-4 pl-3'>
      <form [formGroup]="changeAdminInfoFG">
        <bcp-core-practitioner-info [formGroup]='changeAdminInfoFG'
                                    [showValidationError]='showValidationError'></bcp-core-practitioner-info>

        <div class="form-group">
          <common-date name='changeAdminInfoEffectiveDate'
                        formControlName='changeAdminInfoEffectiveDate'
                        label='Effective date of change'
                        [dateRangeStart]='retroActiveStartDate'
                        [errorMessage]='retroActiveStartDateErrorMessage'></common-date>
        </div>
      </form>
    </div>

<!-- Cancel Facility Number -->

    <a name='cancel-facility'></a>
    <h2 class='mt-5' [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_FAC_NUM_TITLE'></h2>
    <div [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_FAC_NUM_DESCRIPTION'></div>
    <hr/>
    <div class="form-group pl-4">
      <common-checkbox label='Cancel Facility Number'
                        formControlName='checkCancelFacilityNumber'></common-checkbox>
    </div>

    <div *ngIf='dataService.checkCancelFacilityNumber'
          class='border-left ml-4 pl-3'>
      <form [formGroup]="cancelFacilityNumberFG">
        <div class="form-group">
          <common-date name='cancelFacilityNumberCancelDate'
                        formControlName='cancelFacilityNumberCancelDate'
                        label='Cancellation Date'
                        [dateRangeStart]='retroActiveStartDate'
                        [errorMessage]='retroActiveStartDateErrorMessage'></common-date>
        </div>
      </form>
    </div>

    <h2 class='mt-5' [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_OTHER_TITLE'></h2>
    <div [innerHTML]='textService.textValues.SPA_TEXT_UPDATE_FACILITY_CHANGE_CANCEL_PAGE_OTHER_DESCRIPTION'></div>
    <hr/>

    <a name='other-request'></a>
    <div class='form-group'>
      <div>
        <label class='control-label'
               for='otherChangeRequests'>Please enter any other change or request here</label>
        <textarea class='form-control'
                  rows='7'
                  name='otherChangeRequests'
                  formControlName='otherChangeRequests'
                  id='otherChangeRequests'
                  [maxlength]='OTHER_REQUEST_MAX_LENGTH'></textarea>
      </div>
      <div class='text-right'>Characters remaining: {{ OTHER_REQUEST_MAX_LENGTH - dataService.otherChangeRequests.length }}</div>
    </div>

    <common-error-container [displayError]='!hasValidChange && hasValidChange !== undefined'>
      You need to choose at least one option in this page in order to continue.
    </common-error-container>

    <common-error-container [displayError]='systemDownError'>
      Unable to continue, system unavailable. Please try again later.
    </common-error-container>

  </form>
</common-page-section>
